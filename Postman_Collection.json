{
  "info": {
    "name": "Callit Backend API",
    "description": "API collection for testing Callit Backend - Order Management & PayFast Integration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Orders",
      "item": [
        {
          "name": "Create Order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userName\": \"Ali Ahmed\",\n  \"userPhone\": \"+923005551234\",\n  \"totalAmount\": 1000,\n  \"ticketsPurchased\": [\n    {\n      \"ticketId\": \"T1\",\n      \"quantity\": 2,\n      \"price\": 500\n    }\n  ]\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/orders/create",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "orders",
                "create"
              ]
            },
            "description": "Create a new order for event tickets. Copy the orderId from the response to use in PayFast endpoints."
          },
          "response": []
        },
        {
          "name": "Get Order by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:5000/api/orders/ORD-1234567890-123",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "orders",
                "ORD-1234567890-123"
              ]
            },
            "description": "Retrieve order details by Order ID. Replace ORD-1234567890-123 with actual Order ID from create order response."
          },
          "response": []
        }
      ],
      "description": "Order management endpoints"
    },
    {
      "name": "PayFast Pakistan",
      "item": [
        {
          "name": "STEP 1: Get Access Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"ORD-1764355438292-685\",\n  \"amount\": 1000,\n  \"customerIp\": \"192.168.1.1\"\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/payfast/get-token",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "get-token"
              ]
            },
            "description": "Step 1: Get access token from PayFast Pakistan using grant_type: client_credentials. Returns token, refresh_token, and expiry. Required before initializing payment."
          },
          "response": []
        },
        {
          "name": "STEP 2: Initialize Payment (Get Form Data)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"ORD-1764355438292-685\",\n  \"email_address\": \"customer@example.com\",\n  \"token\": \"ACCESS_TOKEN_FROM_STEP_1\"\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/payfast/initialize",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "initialize"
              ]
            },
            "description": "Step 2: Initialize payment with the ACCESS_TOKEN from Step 1. Returns form data and checkout URL to submit to PayFast. Replace token with the actual ACCESS_TOKEN from Step 1 response."
          },
          "response": []
        },
        {
          "name": "Get Payment Status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:5000/api/payfast/status/ORD-1764355438292-685",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "status",
                "ORD-1764355438292-685"
              ]
            },
            "description": "Get payment status for an order. Replace orderId with actual Order ID."
          },
          "response": []
        },
        {
          "name": "Get All Payments",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:5000/api/payfast/list",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "list"
              ]
            },
            "description": "Get all payment records with optional filters (status, orderId)"
          },
          "response": []
        },
        {
          "name": "PayFast Callback (Server-to-Server)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"m_payment_id\": \"ORD-1764355438292-685\",\n  \"pf_payment_id\": \"1234567890\",\n  \"payment_status\": \"COMPLETE\",\n  \"item_name\": \"Event Tickets\",\n  \"item_description\": \"Event ticket payment\",\n  \"amount_gross\": \"1000\",\n  \"amount_fee\": \"50\",\n  \"amount_net\": \"950\",\n  \"name_first\": \"Ali\",\n  \"name_last\": \"Ahmed\",\n  \"email_address\": \"customer@example.com\",\n  \"merchant_id\": \"243483\",\n  \"signature\": \"test_signature\"\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/payfast/callback",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "callback"
              ]
            },
            "description": "PayFast callback endpoint - Called by PayFast server after payment processing. This is server-to-server communication."
          },
          "response": []
        },
        {
          "name": "Retry Payment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"ORD-1764355438292-685\",\n  \"email_address\": \"customer@example.com\"\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/payfast/retry",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "retry"
              ]
            },
            "description": "Retry payment for a failed order. Returns new payment link."
          },
          "response": []
        },
        {
          "name": "Cancel Payment",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "http://localhost:5000/api/payfast/cancel/ORD-1764355438292-685",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "cancel",
                "ORD-1764355438292-685"
              ]
            },
            "description": "Cancel payment for an order. Only works for pending/failed orders."
          },
          "response": []
        },
        {
          "name": "PayFast Redirect (Backward Compatibility)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"ORD-1764355438292-685\",\n  \"email_address\": \"customer@example.com\",\n  \"token\": \"ACCESS_TOKEN_FROM_STEP_1\"\n}"
            },
            "url": {
              "raw": "http://localhost:5000/api/payfast/redirect",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "5000",
              "path": [
                "api",
                "payfast",
                "redirect"
              ]
            },
            "description": "Alias for initialize endpoint (same as STEP 2). Kept for backward compatibility."
          },
          "response": []
        }
      ],
      "description": "PayFast Pakistan payment integration - 2-step token-based flow"
    },
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:5000/",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "5000",
          "path": [
            ""
          ]
        },
        "description": "Check if the backend server is running"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    }
  ]
}
